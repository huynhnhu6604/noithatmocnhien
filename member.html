<!DOCTYPE html>
<html lang="vi">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>T√†i kho·∫£n - N·ªôi th·∫•t M·ªôc Nhi√™n</title>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">
        
        <!-- Firebase SDK -->
        <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
        <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
        <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-analytics-compat.js"></script>
        <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-database-compat.js"></script>
        
        <!-- Sweetalert2 -->
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box; 
            }
            body {
                font-family: 'Montserrat', sans-serif;
                background-color: #f9f7f3;
            }
            .header-top {
                display: flex;
                align-items: center;
                justify-content: center;
                background-color: #5a3d2b;
                padding: 18px 0 12px 0;
                box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            }
            .logo {
                width: 90px;
                height: 90px;
                margin-right: 18px;
                border-radius: 60%;
                border: 3px solid #e9c46a;
                box-shadow: 0 0 15px rgba(233, 196, 106, 0.6);
                transition: transform 0.3s, box-shadow 0.3s;
                object-fit: cover;
            }
            .logo:hover {
                transform: scale(1.05);
                box-shadow: 0 0 20px rgba(233, 196, 106, 0.8);
            }
            .store-name {
                font-family: 'Great Vibes', cursive;
                font-size: 2.7rem;
                font-weight: 400;
                color: #e9c46a;
                text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
                letter-spacing: 1.5px;
            }
            .header-nav {
                width: 100%;
                background-color: #4a3322;
                box-shadow: 0 2px 8px rgba(0,0,0,0.04);
                display: flex;
                justify-content: center;
            }
            .nav-links {
                display: flex;
                align-items: center;
                gap: 10px;
                flex-wrap: wrap;
                justify-content: center;
                padding: 0 10px;
                min-height: 48px;
            }
            .nav-btn {
                font-family: 'Montserrat', sans-serif;
                text-decoration: none;
                color: #f9f7f3;
                font-weight: 500;
                padding: 8px 12px;
                border-radius: 5px;
                transition: all 0.3s;
                border: 1px solid transparent;
                letter-spacing: 0.5px;
                text-transform: uppercase;
                font-size: 0.75rem;
                position: relative;
                white-space: nowrap;
            }
            .nav-btn:hover {
                background-color: rgba(233, 196, 106, 0.2);
                border-color: #e9c46a;
            }
            .active {
                background-color: rgba(233, 196, 106, 0.2);
                border: 1px solid #e9c46a;
            }
            
            /* Dropdown menu */
            .dropdown {
                position: relative;
            }
            .mega-menu {
                display: none;
                position: absolute;
                left: 0;
                top: 100%;
                background: #fff;
                box-shadow: 0 8px 24px rgba(0,0,0,0.15);
                padding: 24px 32px;
                display: flex;
                gap: 40px;
                z-index: 100;
                min-width: 800px;
                opacity: 0;
                visibility: hidden;
                transform: translateY(10px);
                transition: all 0.3s ease;
            }
            .dropdown:hover .mega-menu {
                display: flex;
                opacity: 1;
                visibility: visible;
                transform: translateY(0);
            }
            .mega-column {
                display: flex;
                flex-direction: column;
                min-width: 160px;
                margin-right: 24px;
            }
            .mega-menu a {
                color: #555;
                padding: 8px 0;
                text-decoration: none;
                font-size: 0.9rem;
                transition: all 0.2s;
                border-bottom: 1px solid transparent;
            }
            .mega-menu a:hover {
                color: #e9c46a;
                border-bottom: 1px solid #e9c46a;
                transform: translateX(5px);
            }
            
            /* Th√™m m≈©i t√™n cho dropdown */
            .dropdown > .nav-btn::after {
                content: '‚ñº';
                font-size: 0.7em;
                margin-left: 5px;
                display: inline-block;
                transition: transform 0.3s;
            }
            .dropdown:hover > .nav-btn::after {
                transform: rotate(180deg);
            }
            
            /* N√∫t gi·ªè h√†ng */
            .cart-btn {
                display: flex;
                align-items: center;
                gap: 10px;
                color: #d9d1cc;
                padding: 8px 12px;
                border-radius: 5px;
                text-decoration: none;
                transition: all 0.3s;
                font-weight: 600;
                margin-left: 10px;
                font-size: 0.75rem;
            }
            .cart-icon {
                font-size: 2rem;
            }
            .cart-btn:hover {
                background: #d4b054;
                transform: translateY(-2px);
            }
            
            /* Style cho n√∫t ƒëƒÉng nh·∫≠p */
            .login-btn {
                display: flex;
                align-items: center;
                gap: 6px;
                color: #5a3d2b;
                padding: 8px 16px;
                border-radius: 5px;
                text-decoration: none;
                transition: all 0.3s;
                font-weight: 600;
                margin-left: 10px;
                font-size: 0.75rem;
                background-color: #e9c46a;
                border: 1px solid #e9c46a;
            }
            .login-btn:hover {
                background-color: #5a3d2b;
                color: #e9c46a;
                transform: translateY(-2px);
            }

            /* Style cho user menu */
            .user-menu {
                display: flex;
                align-items: center;
                gap: 6px;
                color: #5a3d2b;
                padding: 8px 16px;
                border-radius: 5px;
                text-decoration: none;
                transition: all 0.3s;
                font-weight: 600;
                margin-left: 10px;
                font-size: 0.75rem;
                background-color: #e9c46a;
                border: 1px solid #e9c46a;
            }

            .user-menu:hover {
                background-color: #5a3d2b;
                color: #e9c46a;
                transform: translateY(-2px);
            }

            .user-menu .logout-btn {
                margin-left: 10px;
                cursor: pointer;
                padding: 4px 8px;
                border-radius: 4px;
                background: rgba(255,255,255,0.2);
            }

            .user-menu .logout-btn:hover {
                background: rgba(255,255,255,0.3);
            }

            /* Member Page Styles */
            .member-container {
                max-width: 1200px;
                margin: 40px auto;
                padding: 0 20px;
                display: grid;
                grid-template-columns: 250px 1fr;
                gap: 30px;
            }

            .member-sidebar {
                background: white;
                border-radius: 12px;
                padding: 20px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.08);
                height: fit-content;
            }

            .member-avatar {
                width: 100px;
                height: 100px;
                border-radius: 50%;
                margin: 0 auto 20px;
                display: block;
                border: 3px solid #e9c46a;
            }

            .member-name {
                text-align: center;
                font-size: 1.2rem;
                color: #5a3d2b;
                margin-bottom: 5px;
            }

            .member-email {
                text-align: center;
                color: #666;
                font-size: 0.9rem;
                margin-bottom: 20px;
            }

            .sidebar-menu {
                list-style: none;
            }

            .sidebar-menu li {
                margin-bottom: 10px;
            }

            .sidebar-menu a {
                display: flex;
                align-items: center;
                gap: 10px;
                padding: 10px;
                color: #5a3d2b;
                text-decoration: none;
                border-radius: 6px;
                transition: all 0.3s;
            }

            .sidebar-menu a:hover,
            .sidebar-menu a.active {
                background: #f9f7f3;
                color: #e9c46a;
            }

            .sidebar-menu i {
                font-size: 1.2rem;
            }

            .member-content {
                background: white;
                border-radius: 12px;
                padding: 30px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            }

            .content-header {
                margin-bottom: 30px;
            }

            .content-header h2 {
                font-size: 1.8rem;
                color: #5a3d2b;
                margin-bottom: 10px;
            }

            .content-header p {
                color: #666;
            }

            /* Form Styles */
            .form-group {
                margin-bottom: 20px;
            }

            .form-group label {
                display: block;
                margin-bottom: 8px;
                color: #5a3d2b;
                font-weight: 500;
            }

            .form-control {
                width: 100%;
                padding: 12px;
                border: 1px solid #ddd;
                border-radius: 6px;
                font-size: 1rem;
                transition: all 0.3s;
            }

            .form-control:focus {
                outline: none;
                border-color: #e9c46a;
                box-shadow: 0 0 0 3px rgba(233, 196, 106, 0.2);
            }

            .btn {
                padding: 12px 24px;
                border: none;
                border-radius: 6px;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s;
                font-size: 1rem;
            }

            .btn-primary {
                background: #e9c46a;
                color: #5a3d2b;
            }

            .btn-primary:hover {
                background: #5a3d2b;
                color: #e9c46a;
            }

            /* Order History Styles */
            .order-history {
                background: var(--white);
                border-radius: 12px;
                padding: 30px;
                margin-top: 30px;
                box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            }

            .order-history h2 {
                color: var(--primary-color);
                font-size: 24px;
                margin-bottom: 20px;
                font-family: 'Playfair Display', serif;
            }

            .order-list {
                display: flex;
                flex-direction: column;
                gap: 20px;
            }

            .order-item {
                background: var(--light-bg);
                border-radius: 8px;
                padding: 20px;
                border: 1px solid var(--border-color);
                transition: all 0.3s ease;
                cursor: pointer;
            }

            .order-item:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            }

            .order-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 15px;
                padding-bottom: 15px;
                border-bottom: 1px solid var(--border-color);
            }

            .order-id {
                font-weight: 600;
                color: var(--primary-color);
            }

            .order-date {
                color: var(--text-color);
                opacity: 0.8;
            }

            .order-status {
                padding: 5px 12px;
                border-radius: 20px;
                font-size: 14px;
                font-weight: 500;
            }

            .status-pending {
                background: #fff3cd;
                color: #856404;
            }

            .status-paid {
                background: #d4edda;
                color: #155724;
            }

            .status-shipping {
                background: #cce5ff;
                color: #004085;
            }

            .status-completed {
                background: #d1e7dd;
                color: #0f5132;
            }

            .status-cancelled {
                background: #f8d7da;
                color: #721c24;
            }

            .order-summary {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 15px;
            }

            .summary-item {
                display: flex;
                flex-direction: column;
                gap: 5px;
            }

            .summary-label {
                font-size: 14px;
                color: var(--text-color);
                opacity: 0.8;
            }

            .summary-value {
                font-weight: 500;
                color: var(--text-color);
            }

            .order-total {
                margin-top: 15px;
                padding-top: 15px;
                border-top: 1px solid var(--border-color);
                text-align: right;
                font-weight: 600;
                color: var(--primary-color);
            }

            /* Order Detail Modal Styles */
            .modal {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.7);
                z-index: 1000;
                overflow-y: auto;
            }

            .modal-content {
                position: relative;
                background: #ffffff;
                margin: 50px auto;
                padding: 0;
                width: 90%;
                max-width: 800px;
                border-radius: 12px;
                box-shadow: 0 5px 30px rgba(0,0,0,0.15);
                animation: modalSlideIn 0.3s ease;
            }

            @keyframes modalSlideIn {
                from {
                    transform: translateY(-50px);
                    opacity: 0;
                }
                to {
                    transform: translateY(0);
                    opacity: 1;
                }
            }

            .modal-header {
                padding: 20px 30px;
                border-bottom: 1px solid #e0e0e0;
                display: flex;
                justify-content: space-between;
                align-items: center;
                background: linear-gradient(135deg, #5a3d2b 0%, #4a3223 100%);
                color: #ffffff;
                border-radius: 12px 12px 0 0;
            }

            .modal-header h2 {
                font-size: 24px;
                font-family: 'Playfair Display', serif;
                margin: 0;
            }

            .close-button {
                background: none;
                border: none;
                color: var(--white);
                font-size: 24px;
                cursor: pointer;
                padding: 0;
                width: 30px;
                height: 30px;
                display: flex;
                align-items: center;
                justify-content: center;
                border-radius: 50%;
                transition: all 0.3s ease;
            }

            .close-button:hover {
                background: rgba(255,255,255,0.1);
            }

            .modal-body {
                padding: 30px;
                max-height: 70vh;
                overflow-y: auto;
                background: #ffffff;
            }

            .modal-footer {
                padding: 20px 30px;
                border-top: 1px solid #e0e0e0;
                display: flex;
                justify-content: flex-end;
                gap: 15px;
                background: #f5f5f5;
                border-radius: 0 0 12px 12px;
            }

            .order-detail-section {
                background: #ffffff;
                border-radius: 8px;
                padding: 20px;
                margin-bottom: 20px;
                box-shadow: 0 2px 8px rgba(0,0,0,0.05);
                border: 1px solid #e0e0e0;
            }

            .order-detail-section h3 {
                color: var(--primary-color);
                font-size: 18px;
                margin-bottom: 20px;
                font-family: 'Playfair Display', serif;
            }

            .detail-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 20px;
            }

            .detail-item {
                display: flex;
                flex-direction: column;
                gap: 5px;
            }

            .detail-label {
                font-size: 14px;
                color: var(--text-color);
                opacity: 0.8;
            }

            .detail-value {
                font-weight: 500;
                color: var(--text-color);
            }

            .product-list {
                margin-top: 20px;
            }

            .product-item {
                display: flex;
                align-items: center;
                gap: 15px;
                padding: 15px;
                border: 1px solid #e0e0e0;
                border-radius: 8px;
                margin-bottom: 10px;
                transition: all 0.3s ease;
                background: #ffffff;
            }

            .product-item:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            }

            .product-image {
                width: 80px;
                height: 80px;
                object-fit: cover;
                border-radius: 4px;
                border: 1px solid var(--border-color);
            }

            .product-info {
                flex: 1;
            }

            .product-name {
                font-weight: 500;
                margin-bottom: 5px;
                color: var(--primary-color);
            }

            .product-price {
                color: var(--primary-color);
                font-weight: 600;
            }

            .product-quantity {
                color: var(--text-color);
                opacity: 0.8;
            }

            .payment-info {
                background: #f5f5f5;
                padding: 20px;
                border-radius: 8px;
                margin-top: 20px;
            }

            .timeline {
                margin-top: 30px;
                position: relative;
                padding-left: 30px;
            }

            .timeline::before {
                content: '';
                position: absolute;
                left: 0;
                top: 0;
                bottom: 0;
                width: 2px;
                background: var(--border-color);
            }

            .timeline-item {
                position: relative;
                margin-bottom: 20px;
            }

            .timeline-item::before {
                content: '';
                position: absolute;
                left: -34px;
                top: 0;
                width: 10px;
                height: 10px;
                border-radius: 50%;
                background: var(--primary-color);
                border: 2px solid var(--white);
            }

            .timeline-date {
                font-size: 14px;
                color: var(--text-color);
                opacity: 0.8;
                margin-bottom: 5px;
            }

            .timeline-content {
                font-weight: 500;
            }

            .btn {
                padding: 12px 24px;
                border: none;
                border-radius: 6px;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s;
                font-size: 1rem;
                display: inline-flex;
                align-items: center;
                gap: 8px;
            }

            .btn-primary {
                background: #5a3d2b;
                color: #ffffff;
            }

            .btn-primary:hover {
                background: #4a3223;
                transform: translateY(-2px);
            }

            .btn-secondary {
                background: #f5f5f5;
                color: #5a3d2b;
                border: 1px solid #e0e0e0;
            }

            .btn-secondary:hover {
                background: #e0e0e0;
            }

            @media print {
                body * {
                    visibility: hidden;
                }
                .modal-content,
                .modal-content * {
                    visibility: visible;
                }
                .modal-content {
                    position: absolute;
                    left: 0;
                    top: 0;
                    width: 100%;
                    margin: 0;
                    padding: 20px;
                }
                .modal-header,
                .modal-footer {
                    display: none;
                }
            }

            @media (max-width: 768px) {
                .member-container {
                    grid-template-columns: 1fr;
                }
                
                .member-sidebar {
                    position: sticky;
                    top: 20px;
                }

                .order-history {
                    padding: 20px;
                }

                .modal-content {
                    margin: 20px;
                    width: auto;
                }

                .modal-body {
                    padding: 20px;
                }

                .product-item {
                    flex-direction: column;
                    text-align: center;
                }

                .product-image {
                    width: 120px;
                    height: 120px;
                }

                .modal-footer {
                    flex-direction: column;
                }

                .btn {
                    width: 100%;
                    justify-content: center;
                }
            }
        </style>
    </head>
    <body>
        <div class="header-top">
            <img src="picture/logo.jpg" alt="M·ªôc Nhi√™n Logo" class="logo">
            <div class="store-name">N·ªôi th·∫•t M·ªôc Nhi√™n</div>
        </div>
        <nav class="header-nav">
            <div class="nav-links">
                <a href="index.html" class="nav-btn">Trang ch·ªß</a>
                <div class="dropdown">
                    <a href="products.html" class="nav-btn">S·∫£n ph·∫©m</a>
                    <div class="mega-menu">
                        <div class="mega-column">
                            <a href="products.html?category=Sofa">Sofa</a>
                            <a href="products.html?category=Gh·∫ø d√†i & ƒë√¥n">Gh·∫ø d√†i & ƒë√¥n</a>
                            <a href="products.html?category=B√†n n∆∞·ªõc">B√†n n∆∞·ªõc</a>
                            <a href="products.html?category=T·ªß tivi">T·ªß tivi</a>
                            <a href="products.html?category=K·ªá tr∆∞ng b√†y">K·ªá tr∆∞ng b√†y</a>
                            <a href="products.html?category=T·ªß gi√†y">T·ªß gi√†y</a>
                        </div>
                        <div class="mega-column">
                            <a href="products.html?category=B√†n ƒÉn">B√†n ƒÉn</a>
                            <a href="products.html?category=Gh·∫ø ƒÉn">Gh·∫ø ƒÉn</a>
                            <a href="products.html?category=Gh·∫ø Bar">Gh·∫ø Bar</a>
                            <a href="products.html?category=T·ªß ly">T·ªß ly</a>
                            <a href="products.html?category=T·ªß b·∫øp">T·ªß b·∫øp</a>
                        </div>
                        <div class="mega-column">
                            <a href="products.html?category=Gi∆∞·ªùng ng·ªß">Gi∆∞·ªùng ng·ªß</a>
                            <a href="products.html?category=B√†n ƒë·∫ßu gi∆∞·ªùng">B√†n ƒë·∫ßu gi∆∞·ªùng</a>
                            <a href="products.html?category=B√†n trang ƒëi·ªÉm">B√†n trang ƒëi·ªÉm</a>
                            <a href="products.html?category=T·ªß √°o">T·ªß √°o</a>
                            <a href="products.html?category=N·ªám">N·ªám</a>
                        </div>
                        <div class="mega-column">
                            <a href="products.html?category=B√†n l√†m vi·ªác">B√†n l√†m vi·ªác</a>
                            <a href="products.html?category=Gh·∫ø l√†m vi·ªác">Gh·∫ø l√†m vi·ªác</a>
                            <a href="products.html?category=K·ªá s√°ch">K·ªá s√°ch</a>
                            <a href="products.html?category=B√†n ngo√†i tr·ªùi">B√†n ngo√†i tr·ªùi</a>
                            <a href="products.html?category=Gh·∫ø ngo√†i tr·ªùi">Gh·∫ø ngo√†i tr·ªùi</a>
                        </div>
                        <div class="mega-column">
                            <a href="products.html?category=ƒê√®n trang tr√≠">ƒê√®n trang tr√≠</a>
                            <a href="products.html?category=Th·∫£m trang tr√≠">Th·∫£m trang tr√≠</a>
                            <a href="products.html?category=B√¨nh trang tr√≠">B√¨nh trang tr√≠</a>
                            <a href="products.html?category=Tranh">Tranh</a>
                            <a href="products.html?category=G∆∞∆°ng">G∆∞∆°ng</a>
                            <a href="products.html?category=ƒê·ªìng h·ªì">ƒê·ªìng h·ªì</a>
                            <a href="products.html?category=T∆∞·ª£ng trang tr√≠">T∆∞·ª£ng trang tr√≠</a>
                            <a href="products.html?category=D·ª•ng c·ª• b·∫øp">D·ª•ng c·ª• b·∫øp</a>
                        </div>
                    </div>
                </div>
                <a href="collection.html" class="nav-btn">B·ªô s∆∞u t·∫≠p</a>
                <a href="promotion.html" class="nav-btn">Khuy·∫øn m√£i</a>
                <a href="member.html" class="nav-btn active">Th√†nh vi√™n</a>
                <a href="policy.html" class="nav-btn">Ch√≠nh s√°ch</a>
                <a href="about.html" class="nav-btn">V·ªÅ ch√∫ng t√¥i</a>
                <a href="cart.html" class="cart-btn">
                    <span class="cart-icon">üõí</span>
                    <span>Gi·ªè h√†ng</span>
                </a>
                <div id="authButtons">
                    <a href="#" class="login-btn" onclick="showModal('loginModal')">
                        <span>üë§</span>
                        <span>ƒêƒÉng nh·∫≠p</span>
                    </a>
                </div>
            </div>
        </nav>

        <div class="member-container">
            <div class="member-sidebar">
                <img src="picture/logo.jpg" alt="Avatar" class="member-avatar">
                <h3 class="member-name" id="userName">Loading...</h3>
                <p class="member-email" id="userEmail">Loading...</p>
                
                <ul class="sidebar-menu">
                    <li><a href="#" class="active" onclick="showSection('profile')">
                        <i>üë§</i> Th√¥ng tin c√° nh√¢n
                    </a></li>
                    <li><a href="#" onclick="showSection('orders')">
                        <i>üì¶</i> L·ªãch s·ª≠ ƒë·∫∑t h√†ng
                    </a></li>
                    <li><a href="#" onclick="showSection('address')">
                        <i>üìç</i> ƒê·ªãa ch·ªâ giao h√†ng
                    </a></li>
                    <li><a href="#" onclick="showSection('password')">
                        <i>üîí</i> ƒê·ªïi m·∫≠t kh·∫©u
                    </a></li>
                    <li><a href="#" onclick="logout()">
                        <i>üö™</i> ƒêƒÉng xu·∫•t
                    </a></li>
                </ul>
            </div>

            <div class="member-content">
                <!-- Profile Section -->
                <div id="profileSection" class="content-section">
                    <div class="content-header">
                        <h2>Th√¥ng tin c√° nh√¢n</h2>
                        <p>C·∫≠p nh·∫≠t th√¥ng tin c√° nh√¢n c·ªßa b·∫°n</p>
                    </div>
                    <form id="profileForm" onsubmit="updateProfile(event)">
                        <div class="form-group">
                            <label for="fullName">H·ªç v√† t√™n</label>
                            <input type="text" id="fullName" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="phone">S·ªë ƒëi·ªán tho·∫°i</label>
                            <input type="tel" id="phone" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email" id="email" class="form-control" disabled>
                        </div>
                        <button type="submit" class="btn btn-primary">C·∫≠p nh·∫≠t th√¥ng tin</button>
                    </form>
                </div>

                <!-- Orders Section -->
                <div id="ordersSection" class="content-section" style="display: none;">
                    <div class="content-header">
                        <h2>L·ªãch s·ª≠ ƒë·∫∑t h√†ng</h2>
                        <p>Xem l·∫°i c√°c ƒë∆°n h√†ng c·ªßa b·∫°n</p>
                    </div>
                    <div class="order-history">
                        <div class="order-list" id="orderList">
                            <!-- Orders will be loaded here -->
                        </div>
                    </div>
                </div>

                <!-- Address Section -->
                <div id="addressSection" class="content-section" style="display: none;">
                    <div class="content-header">
                        <h2>ƒê·ªãa ch·ªâ giao h√†ng</h2>
                        <p>Qu·∫£n l√Ω ƒë·ªãa ch·ªâ giao h√†ng c·ªßa b·∫°n</p>
                    </div>
                    <form id="addressForm" onsubmit="updateAddress(event)">
                        <div class="form-group">
                            <label for="address">ƒê·ªãa ch·ªâ</label>
                            <input type="text" id="address" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="city">Th√†nh ph·ªë</label>
                            <input type="text" id="city" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="district">Qu·∫≠n/Huy·ªán</label>
                            <input type="text" id="district" class="form-control" required>
                        </div>
                        <button type="submit" class="btn btn-primary">C·∫≠p nh·∫≠t ƒë·ªãa ch·ªâ</button>
                    </form>
                </div>

                <!-- Password Section -->
                <div id="passwordSection" class="content-section" style="display: none;">
                    <div class="content-header">
                        <h2>ƒê·ªïi m·∫≠t kh·∫©u</h2>
                        <p>C·∫≠p nh·∫≠t m·∫≠t kh·∫©u c·ªßa b·∫°n</p>
                    </div>
                    <form id="passwordForm" onsubmit="updatePassword(event)">
                        <div class="form-group">
                            <label for="currentPassword">M·∫≠t kh·∫©u hi·ªán t·∫°i</label>
                            <input type="password" id="currentPassword" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="newPassword">M·∫≠t kh·∫©u m·ªõi</label>
                            <input type="password" id="newPassword" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="confirmPassword">X√°c nh·∫≠n m·∫≠t kh·∫©u m·ªõi</label>
                            <input type="password" id="confirmPassword" class="form-control" required>
                        </div>
                        <button type="submit" class="btn btn-primary">ƒê·ªïi m·∫≠t kh·∫©u</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Modal Chi ti·∫øt ƒë∆°n h√†ng -->
        <div class="modal" id="orderDetailModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Chi ti·∫øt ƒë∆°n h√†ng</h2>
                    <button class="close-button" onclick="closeModal('orderDetailModal')">&times;</button>
                </div>
                <div class="modal-body" id="orderDetailContent">
                    <!-- Order details will be loaded here -->
                </div>
            </div>
        </div>

        <script>
            // C·∫•u h√¨nh Firebase
            const firebaseConfig = {
                apiKey: "AIzaSyBHTL0ZIZkmRNi7kRF8UJdjR1qhx8cdre4",
                authDomain: "webnoithat-de11f.firebaseapp.com",
                databaseURL: "https://webnoithat-de11f-default-rtdb.firebaseio.com",
                projectId: "webnoithat-de11f",
                storageBucket: "webnoithat-de11f.firebasestorage.app",
                messagingSenderId: "919918511984",
                appId: "1:919918511984:web:d1b260dc52102fd279b1b5",
                measurementId: "G-H1G2WJETSH"
            };

            // Kh·ªüi t·∫°o Firebase
            firebase.initializeApp(firebaseConfig);
            const database = firebase.database();
            const auth = firebase.auth();

            // Bi·∫øn l∆∞u tr·ªØ th√¥ng tin user hi·ªán t·∫°i
            let currentUser = null;

            // Ki·ªÉm tra ƒëƒÉng nh·∫≠p v√† load d·ªØ li·ªáu
            auth.onAuthStateChanged((user) => {
                if (!user) {
                    Swal.fire({
                        title: 'Vui l√≤ng ƒëƒÉng nh·∫≠p',
                        text: 'B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p ƒë·ªÉ truy c·∫≠p trang n√†y',
                        icon: 'warning',
                        confirmButtonText: 'ƒêƒÉng nh·∫≠p'
                    }).then(() => {
                        window.location.href = 'index.html';
                    });
                    return;
                }

                currentUser = user;
                loadUserData(user);
                loadOrders(user.uid);
                updateAuthButtons(user);
            });

            // Load th√¥ng tin user
            function loadUserData(user) {
                try {
                    document.getElementById('userName').textContent = user.displayName || 'Ch∆∞a c·∫≠p nh·∫≠t';
                    document.getElementById('userEmail').textContent = user.email;

                    // Load th√¥ng tin chi ti·∫øt t·ª´ database
                    database.ref('users/' + user.uid).once('value')
                        .then((snapshot) => {
                            const userData = snapshot.val();
                            if (userData) {
                                document.getElementById('fullName').value = userData.displayName || '';
                                document.getElementById('phone').value = userData.phone || '';
                                document.getElementById('email').value = user.email;
                                document.getElementById('address').value = userData.address || '';
                                document.getElementById('city').value = userData.city || '';
                                document.getElementById('district').value = userData.district || '';
                            }
                        })
                        .catch((error) => {
                            console.error('L·ªói khi load th√¥ng tin user:', error);
                            Swal.fire('L·ªói', 'Kh√¥ng th·ªÉ t·∫£i th√¥ng tin ng∆∞·ªùi d√πng', 'error');
                        });
                } catch (error) {
                    console.error('L·ªói khi x·ª≠ l√Ω th√¥ng tin user:', error);
                    Swal.fire('L·ªói', 'C√≥ l·ªói x·∫£y ra khi x·ª≠ l√Ω th√¥ng tin', 'error');
                }
            }

            // Load l·ªãch s·ª≠ ƒë·∫∑t h√†ng
            function loadOrders(userId) {
                const orderList = document.getElementById('orderList');
                
                try {
                    database.ref('orders').orderByChild('userId').equalTo(userId).on('value', (snapshot) => {
                        const orders = snapshot.val();
                        orderList.innerHTML = '';

                        if (!orders) {
                            orderList.innerHTML = '<p>B·∫°n ch∆∞a c√≥ ƒë∆°n h√†ng n√†o</p>';
                            return;
                        }

                        Object.entries(orders).forEach(([orderId, order]) => {
                            if (!order || !order.items) return;

                            const statusClass = {
                                'pending': 'status-pending',
                                'processing': 'status-processing',
                                'completed': 'status-completed',
                                'cancelled': 'status-cancelled'
                            }[order.status] || 'status-pending';

                            const statusText = {
                                'pending': 'Ch·ªù x√°c nh·∫≠n',
                                'processing': 'ƒêang x·ª≠ l√Ω',
                                'completed': 'Ho√†n th√†nh',
                                'cancelled': 'ƒê√£ h·ªßy'
                            }[order.status] || 'Ch·ªù x√°c nh·∫≠n';

                            const orderDate = new Date(order.createdAt).toLocaleString();

                            let orderItems = '';
                            order.items.forEach(item => {
                                if (!item) return;
                                orderItems += `
                                    <div class="order-item">
                                        <img src="${item.image || 'picture/logo.jpg'}" alt="${item.name || 'S·∫£n ph·∫©m'}" class="item-image">
                                        <div class="item-details">
                                            <h4 class="item-name">${item.name || 'S·∫£n ph·∫©m kh√¥ng x√°c ƒë·ªãnh'}</h4>
                                            <p class="item-price">${(item.price || 0).toLocaleString()}ƒë x ${item.quantity || 1}</p>
                                        </div>
                                    </div>
                                `;
                            });

                            orderList.innerHTML += `
                                <div class="order-card">
                                    <div class="order-header">
                                        <span class="order-number">ƒê∆°n h√†ng #${orderId}</span>
                                        <span class="order-status ${statusClass}">${statusText}</span>
                                    </div>
                                    <div class="order-items">
                                        ${orderItems}
                                    </div>
                                    <div class="order-footer">
                                        <span class="order-total">T·ªïng ti·ªÅn: ${(order.total || 0).toLocaleString()}ƒë</span>
                                        <div class="order-actions">
                                            <button class="btn btn-outline" onclick="viewOrderDetail('${orderId}')">Chi ti·∫øt</button>
                                            ${order.status === 'pending' ? `
                                                <button class="btn btn-outline" onclick="cancelOrder('${orderId}')">H·ªßy ƒë∆°n</button>
                                            ` : ''}
                                        </div>
                                    </div>
                                </div>
                            `;
                        });
                    }, (error) => {
                        console.error('L·ªói khi load ƒë∆°n h√†ng:', error);
                        Swal.fire('L·ªói', 'Kh√¥ng th·ªÉ t·∫£i l·ªãch s·ª≠ ƒë∆°n h√†ng', 'error');
                    });
                } catch (error) {
                    console.error('L·ªói khi x·ª≠ l√Ω ƒë∆°n h√†ng:', error);
                    Swal.fire('L·ªói', 'C√≥ l·ªói x·∫£y ra khi x·ª≠ l√Ω ƒë∆°n h√†ng', 'error');
                }
            }

            // C·∫≠p nh·∫≠t th√¥ng tin c√° nh√¢n
            function updateProfile(event) {
                event.preventDefault();
                if (!currentUser) return;

                const fullName = document.getElementById('fullName').value.trim();
                const phone = document.getElementById('phone').value.trim();

                if (!fullName) {
                    Swal.fire('L·ªói', 'Vui l√≤ng nh·∫≠p h·ªç t√™n', 'error');
                    return;
                }

                if (!phone) {
                    Swal.fire('L·ªói', 'Vui l√≤ng nh·∫≠p s·ªë ƒëi·ªán tho·∫°i', 'error');
                    return;
                }

                // Validate phone number
                const phoneRegex = /^[0-9]{10,11}$/;
                if (!phoneRegex.test(phone)) {
                    Swal.fire('L·ªói', 'S·ªë ƒëi·ªán tho·∫°i kh√¥ng h·ª£p l·ªá', 'error');
                    return;
                }

                const userData = {
                    displayName: fullName,
                    phone: phone
                };

                // Show loading
                Swal.fire({
                    title: 'ƒêang c·∫≠p nh·∫≠t...',
                    allowOutsideClick: false,
                    didOpen: () => {
                        Swal.showLoading();
                    }
                });

                database.ref('users/' + currentUser.uid).update(userData)
                    .then(() => {
                        // Update display name in auth
                        return currentUser.updateProfile({
                            displayName: fullName
                        });
                    })
                    .then(() => {
                        Swal.fire('Th√†nh c√¥ng', 'Th√¥ng tin ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t', 'success');
                        loadUserData(currentUser);
                    })
                    .catch((error) => {
                        console.error('L·ªói khi c·∫≠p nh·∫≠t th√¥ng tin:', error);
                        Swal.fire('L·ªói', 'Kh√¥ng th·ªÉ c·∫≠p nh·∫≠t th√¥ng tin', 'error');
                    });
            }

            // C·∫≠p nh·∫≠t ƒë·ªãa ch·ªâ
            function updateAddress(event) {
                event.preventDefault();
                if (!currentUser) return;

                const address = document.getElementById('address').value.trim();
                const city = document.getElementById('city').value.trim();
                const district = document.getElementById('district').value.trim();

                if (!address || !city || !district) {
                    Swal.fire('L·ªói', 'Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin ƒë·ªãa ch·ªâ', 'error');
                    return;
                }

                const addressData = {
                    address: address,
                    city: city,
                    district: district
                };

                // Show loading
                Swal.fire({
                    title: 'ƒêang c·∫≠p nh·∫≠t...',
                    allowOutsideClick: false,
                    didOpen: () => {
                        Swal.showLoading();
                    }
                });

                database.ref('users/' + currentUser.uid).update(addressData)
                    .then(() => {
                        Swal.fire('Th√†nh c√¥ng', 'ƒê·ªãa ch·ªâ ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t', 'success');
                    })
                    .catch((error) => {
                        console.error('L·ªói khi c·∫≠p nh·∫≠t ƒë·ªãa ch·ªâ:', error);
                        Swal.fire('L·ªói', 'Kh√¥ng th·ªÉ c·∫≠p nh·∫≠t ƒë·ªãa ch·ªâ', 'error');
                    });
            }

            // ƒê·ªïi m·∫≠t kh·∫©u
            function updatePassword(event) {
                event.preventDefault();
                if (!currentUser) return;

                const currentPassword = document.getElementById('currentPassword').value;
                const newPassword = document.getElementById('newPassword').value;
                const confirmPassword = document.getElementById('confirmPassword').value;

                if (!currentPassword || !newPassword || !confirmPassword) {
                    Swal.fire('L·ªói', 'Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin', 'error');
                    return;
                }

                if (newPassword !== confirmPassword) {
                    Swal.fire('L·ªói', 'M·∫≠t kh·∫©u x√°c nh·∫≠n kh√¥ng kh·ªõp', 'error');
                    return;
                }

                if (newPassword.length < 6) {
                    Swal.fire('L·ªói', 'M·∫≠t kh·∫©u m·ªõi ph·∫£i c√≥ √≠t nh·∫•t 6 k√Ω t·ª±', 'error');
                    return;
                }

                // Show loading
                Swal.fire({
                    title: 'ƒêang x·ª≠ l√Ω...',
                    allowOutsideClick: false,
                    didOpen: () => {
                        Swal.showLoading();
                    }
                });

                // Reauthenticate user
                const credential = firebase.auth.EmailAuthProvider.credential(
                    currentUser.email,
                    currentPassword
                );

                currentUser.reauthenticateWithCredential(credential)
                    .then(() => {
                        return currentUser.updatePassword(newPassword);
                    })
                    .then(() => {
                        Swal.fire('Th√†nh c√¥ng', 'M·∫≠t kh·∫©u ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t', 'success');
                        document.getElementById('passwordForm').reset();
                    })
                    .catch((error) => {
                        console.error('L·ªói khi ƒë·ªïi m·∫≠t kh·∫©u:', error);
                        if (error.code === 'auth/wrong-password') {
                            Swal.fire('L·ªói', 'M·∫≠t kh·∫©u hi·ªán t·∫°i kh√¥ng ƒë√∫ng', 'error');
                        } else {
                            Swal.fire('L·ªói', 'Kh√¥ng th·ªÉ c·∫≠p nh·∫≠t m·∫≠t kh·∫©u', 'error');
                        }
                    });
            }

            // Xem chi ti·∫øt ƒë∆°n h√†ng
            function viewOrderDetail(orderId) {
                if (!orderId) return;

                // Show loading
                Swal.fire({
                    title: 'ƒêang t·∫£i...',
                    allowOutsideClick: false,
                    didOpen: () => {
                        Swal.showLoading();
                    }
                });

                database.ref('orders/' + orderId).once('value')
                    .then((snapshot) => {
                        const order = snapshot.val();
                        if (!order) {
                            throw new Error('Kh√¥ng t√¨m th·∫•y ƒë∆°n h√†ng');
                        }

                        const orderDate = new Date(order.createdAt).toLocaleString();
                        const statusText = {
                            'pending': 'Ch·ªù x√°c nh·∫≠n',
                            'processing': 'ƒêang x·ª≠ l√Ω',
                            'completed': 'Ho√†n th√†nh',
                            'cancelled': 'ƒê√£ h·ªßy'
                        }[order.status] || 'Ch·ªù x√°c nh·∫≠n';

                        let itemsHtml = '';
                        if (order.items && order.items.length > 0) {
                            itemsHtml = order.items.map(item => `
                                <div style="margin-bottom: 10px;">
                                    <p><strong>${item.name}</strong></p>
                                    <p>S·ªë l∆∞·ª£ng: ${item.quantity}</p>
                                    <p>Gi√°: ${item.price.toLocaleString()}ƒë</p>
                                </div>
                            `).join('');
                        }

                        Swal.fire({
                            title: `Chi ti·∫øt ƒë∆°n h√†ng #${orderId}`,
                            html: `
                                <div style="text-align: left;">
                                    <p><strong>Ng√†y ƒë·∫∑t:</strong> ${orderDate}</p>
                                    <p><strong>Tr·∫°ng th√°i:</strong> ${statusText}</p>
                                    <p><strong>ƒê·ªãa ch·ªâ giao h√†ng:</strong> ${order.shippingAddress || 'Ch∆∞a c·∫≠p nh·∫≠t'}</p>
                                    <p><strong>T·ªïng ti·ªÅn:</strong> ${(order.total || 0).toLocaleString()}ƒë</p>
                                    <hr>
                                    <h4>S·∫£n ph·∫©m:</h4>
                                    ${itemsHtml}
                                </div>
                            `,
                            width: '600px'
                        });
                    })
                    .catch((error) => {
                        console.error('L·ªói khi xem chi ti·∫øt ƒë∆°n h√†ng:', error);
                        Swal.fire('L·ªói', 'Kh√¥ng th·ªÉ t·∫£i th√¥ng tin ƒë∆°n h√†ng', 'error');
                    });
            }

            // H·ªßy ƒë∆°n h√†ng
            function cancelOrder(orderId) {
                if (!orderId) return;

                Swal.fire({
                    title: 'X√°c nh·∫≠n h·ªßy ƒë∆°n',
                    text: 'B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën h·ªßy ƒë∆°n h√†ng n√†y?',
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonText: 'H·ªßy ƒë∆°n',
                    cancelButtonText: 'Kh√¥ng'
                }).then((result) => {
                    if (result.isConfirmed) {
                        // Show loading
                        Swal.fire({
                            title: 'ƒêang x·ª≠ l√Ω...',
                            allowOutsideClick: false,
                            didOpen: () => {
                                Swal.showLoading();
                            }
                        });

                        database.ref('orders/' + orderId).update({
                            status: 'cancelled',
                            cancelledAt: firebase.database.ServerValue.TIMESTAMP
                        }).then(() => {
                            Swal.fire('Th√†nh c√¥ng', 'ƒê∆°n h√†ng ƒë√£ ƒë∆∞·ª£c h·ªßy', 'success');
                        }).catch((error) => {
                            console.error('L·ªói khi h·ªßy ƒë∆°n h√†ng:', error);
                            Swal.fire('L·ªói', 'Kh√¥ng th·ªÉ h·ªßy ƒë∆°n h√†ng', 'error');
                        });
                    }
                });
            }

            // Hi·ªÉn th·ªã section
            function showSection(sectionId) {
                if (!sectionId) return;

                // ·∫®n t·∫•t c·∫£ c√°c section
                document.querySelectorAll('.content-section').forEach(section => {
                    section.style.display = 'none';
                });

                // Hi·ªÉn th·ªã section ƒë∆∞·ª£c ch·ªçn
                const selectedSection = document.getElementById(sectionId + 'Section');
                if (selectedSection) {
                    selectedSection.style.display = 'block';
                    // T·∫£i l·∫°i l·ªãch s·ª≠ ƒë∆°n h√†ng n·∫øu ƒëang ·ªü tab orders
                    if (sectionId === 'orders') {
                        loadOrderHistory();
                    }
                }

                // C·∫≠p nh·∫≠t active state cho menu
                document.querySelectorAll('.sidebar-menu a').forEach(link => {
                    link.classList.remove('active');
                });
                event.currentTarget.classList.add('active');
            }

            // ƒêƒÉng xu·∫•t
            function logout() {
                Swal.fire({
                    title: 'X√°c nh·∫≠n ƒëƒÉng xu·∫•t',
                    text: 'B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ƒëƒÉng xu·∫•t?',
                    icon: 'question',
                    showCancelButton: true,
                    confirmButtonText: 'ƒêƒÉng xu·∫•t',
                    cancelButtonText: 'H·ªßy'
                }).then((result) => {
                    if (result.isConfirmed) {
                        // Show loading
                        Swal.fire({
                            title: 'ƒêang ƒëƒÉng xu·∫•t...',
                            allowOutsideClick: false,
                            didOpen: () => {
                                Swal.showLoading();
                            }
                        });

                        auth.signOut().then(() => {
                            window.location.href = 'index.html';
                        }).catch((error) => {
                            console.error('L·ªói khi ƒëƒÉng xu·∫•t:', error);
                            Swal.fire('L·ªói', 'Kh√¥ng th·ªÉ ƒëƒÉng xu·∫•t', 'error');
                        });
                    }
                });
            }

            // X·ª≠ l√Ω l·ªói chung
            window.onerror = function(msg, url, lineNo, columnNo, error) {
                console.error('L·ªói:', msg, 'URL:', url, 'Line:', lineNo, 'Column:', columnNo, 'Error:', error);
                return false;
            };

            // H√†m t·∫£i l·ªãch s·ª≠ ƒë∆°n h√†ng
            async function loadOrderHistory() {
                try {
                    const user = auth.currentUser;
                    if (!user) return;

                    const ordersRef = database.ref('orders');
                    const snapshot = await ordersRef.orderByChild('email').equalTo(user.email).once('value');
                    const orders = [];
                    
                    snapshot.forEach((childSnapshot) => {
                        const orderData = childSnapshot.val();
                        orders.push({
                            id: childSnapshot.key,
                            ...orderData
                        });
                    });

                    // S·∫Øp x·∫øp ƒë∆°n h√†ng theo th·ªùi gian t·∫°o (m·ªõi nh·∫•t l√™n ƒë·∫ßu)
                    orders.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));

                    const orderList = document.getElementById('orderList');
                    orderList.innerHTML = orders.length ? '' : '<p>B·∫°n ch∆∞a c√≥ ƒë∆°n h√†ng n√†o</p>';

                    orders.forEach(order => {
                        const orderElement = createOrderElement(order);
                        orderList.appendChild(orderElement);
                    });
                } catch (error) {
                    console.error('L·ªói khi t·∫£i l·ªãch s·ª≠ ƒë∆°n h√†ng:', error);
                    showError('L·ªói', 'Kh√¥ng th·ªÉ t·∫£i l·ªãch s·ª≠ ƒë∆°n h√†ng. Vui l√≤ng th·ª≠ l·∫°i sau.');
                }
            }

            // H√†m t·∫°o element ƒë∆°n h√†ng
            function createOrderElement(order) {
                const div = document.createElement('div');
                div.className = 'order-item';
                div.onclick = () => showOrderDetail(order);

                const statusClass = getStatusClass(order.status);
                const statusText = getStatusText(order.status);
                const orderDate = new Date(order.createdAt).toLocaleDateString('vi-VN', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });

                div.innerHTML = `
                    <div class="order-header">
                        <div>
                            <span class="order-id">ƒê∆°n h√†ng #${order.orderId}</span>
                            <span class="order-date">${orderDate}</span>
                        </div>
                        <span class="order-status ${statusClass}">${statusText}</span>
                    </div>
                    <div class="order-summary">
                        <div class="summary-item">
                            <span class="summary-label">Ng∆∞·ªùi nh·∫≠n</span>
                            <span class="summary-value">${order.fullName}</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">S·ªë ƒëi·ªán tho·∫°i</span>
                            <span class="summary-value">${order.phone}</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">ƒê·ªãa ch·ªâ</span>
                            <span class="summary-value">${order.address}</span>
                        </div>
                    </div>
                    <div class="order-total">
                        T·ªïng ti·ªÅn: ${order.grandTotal.toLocaleString('vi-VN')}ƒë
                    </div>
                `;

                return div;
            }

            // H√†m hi·ªÉn th·ªã chi ti·∫øt ƒë∆°n h√†ng
            function showOrderDetail(order) {
                const modal = document.getElementById('orderDetailModal');
                const content = document.getElementById('orderDetailContent');

                const orderDate = new Date(order.createdAt).toLocaleDateString('vi-VN', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });

                const paymentDate = order.paymentDate ? new Date(order.paymentDate).toLocaleDateString('vi-VN', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                }) : 'Ch∆∞a thanh to√°n';

                content.innerHTML = `
                    <div class="order-detail-section">
                        <h3>Th√¥ng tin ƒë∆°n h√†ng</h3>
                        <div class="detail-grid">
                            <div class="detail-item">
                                <span class="detail-label">M√£ ƒë∆°n h√†ng</span>
                                <span class="detail-value">${order.orderId}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">M√£ giao d·ªãch</span>
                                <span class="detail-value">${order.orderKey}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Ng√†y ƒë·∫∑t</span>
                                <span class="detail-value">${orderDate}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Tr·∫°ng th√°i</span>
                                <span class="detail-value">${getStatusText(order.status)}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Ph∆∞∆°ng th·ª©c thanh to√°n</span>
                                <span class="detail-value">${order.paymentMethod === 'vnpay' ? 'VNPAY' : 'Thanh to√°n khi nh·∫≠n h√†ng'}</span>
                            </div>
                        </div>
                    </div>

                    <div class="order-detail-section">
                        <h3>Th√¥ng tin ng∆∞·ªùi nh·∫≠n</h3>
                        <div class="detail-grid">
                            <div class="detail-item">
                                <span class="detail-label">H·ªç v√† t√™n</span>
                                <span class="detail-value">${order.fullName}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">S·ªë ƒëi·ªán tho·∫°i</span>
                                <span class="detail-value">${order.phone}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Email</span>
                                <span class="detail-value">${order.email}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">ƒê·ªãa ch·ªâ</span>
                                <span class="detail-value">${order.address}</span>
                            </div>
                        </div>
                    </div>

                    <div class="order-detail-section">
                        <h3>S·∫£n ph·∫©m</h3>
                        <div class="product-list">
                            ${order.items && order.items.length > 0 ? order.items.map(item => `
                                <div class="product-item">
                                    <img src="${item.image || 'picture/logo.jpg'}" alt="${item.name || 'S·∫£n ph·∫©m'}" class="product-image">
                                    <div class="product-info">
                                        <div class="product-name">${item.name || 'S·∫£n ph·∫©m kh√¥ng x√°c ƒë·ªãnh'}</div>
                                        <div class="product-price">${(item.price || 0).toLocaleString('vi-VN')}ƒë</div>
                                        <div class="product-quantity">S·ªë l∆∞·ª£ng: ${item.quantity || 1}</div>
                                    </div>
                                </div>
                            `).join('') : '<p>Kh√¥ng c√≥ th√¥ng tin s·∫£n ph·∫©m</p>'}
                        </div>
                    </div>

                    ${order.paymentMethod === 'vnpay' ? `
                        <div class="order-detail-section">
                            <h3>Th√¥ng tin thanh to√°n</h3>
                            <div class="payment-info">
                                <div class="detail-grid">
                                    <div class="detail-item">
                                        <span class="detail-label">M√£ giao d·ªãch VNPAY</span>
                                        <span class="detail-value">${order.paymentDetails.transactionNo}</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-label">M√£ giao d·ªãch ng√¢n h√†ng</span>
                                        <span class="detail-value">${order.paymentDetails.bankTranNo}</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-label">Ng√¢n h√†ng</span>
                                        <span class="detail-value">${order.paymentDetails.bankCode}</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-label">Th·ªùi gian thanh to√°n</span>
                                        <span class="detail-value">${paymentDate}</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-label">Tr·∫°ng th√°i thanh to√°n</span>
                                        <span class="detail-value">${order.paymentStatus === 'completed' ? 'Ho√†n th√†nh' : 'Ch∆∞a ho√†n th√†nh'}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    ` : ''}

                    <div class="order-detail-section">
                        <h3>T·ªïng thanh to√°n</h3>
                        <div class="detail-grid">
                            <div class="detail-item">
                                <span class="detail-label">T·∫°m t√≠nh</span>
                                <span class="detail-value">${(order.subtotal || 0).toLocaleString('vi-VN')}ƒë</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Ph√≠ v·∫≠n chuy·ªÉn</span>
                                <span class="detail-value">${(order.shipping || 0).toLocaleString('vi-VN')}ƒë</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">T·ªïng c·ªông</span>
                                <span class="detail-value" style="color: var(--primary-color); font-weight: 600;">
                                    ${(order.grandTotal || 0).toLocaleString('vi-VN')}ƒë
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="order-detail-section">
                        <h3>L·ªãch s·ª≠ ƒë∆°n h√†ng</h3>
                        <div class="timeline">
                            <div class="timeline-item">
                                <div class="timeline-date">${orderDate}</div>
                                <div class="timeline-content">ƒê∆°n h√†ng ƒë∆∞·ª£c t·∫°o</div>
                            </div>
                            ${order.paymentDate ? `
                                <div class="timeline-item">
                                    <div class="timeline-date">${paymentDate}</div>
                                    <div class="timeline-content">Thanh to√°n th√†nh c√¥ng</div>
                                </div>
                            ` : ''}
                            ${order.status === 'completed' && order.updatedAt ? `
                                <div class="timeline-item">
                                    <div class="timeline-date">${new Date(order.updatedAt).toLocaleDateString('vi-VN')}</div>
                                    <div class="timeline-content">ƒê∆°n h√†ng ho√†n th√†nh</div>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                `;

                modal.style.display = 'block';
            }

            // H√†m l·∫•y class cho tr·∫°ng th√°i
            function getStatusClass(status) {
                switch (status) {
                    case 'pending': return 'status-pending';
                    case 'paid': return 'status-paid';
                    case 'shipping': return 'status-shipping';
                    case 'completed': return 'status-completed';
                    case 'cancelled': return 'status-cancelled';
                    default: return '';
                }
            }

            // H√†m l·∫•y text cho tr·∫°ng th√°i
            function getStatusText(status) {
                switch (status) {
                    case 'pending': return 'Ch·ªù thanh to√°n';
                    case 'paid': return 'ƒê√£ thanh to√°n';
                    case 'shipping': return 'ƒêang giao h√†ng';
                    case 'completed': return 'Ho√†n th√†nh';
                    case 'cancelled': return 'ƒê√£ h·ªßy';
                    default: return 'Kh√¥ng x√°c ƒë·ªãnh';
                }
            }

            // Th√™m v√†o h√†m initMemberPage
            function initMemberPage() {
                const user = auth.currentUser;
                if (user) {
                    document.getElementById('userName').textContent = user.displayName || 'Ch∆∞a c·∫≠p nh·∫≠t';
                    document.getElementById('userEmail').textContent = user.email;
                    loadUserData(user);
                    loadOrderHistory();
                }
            }

            // H√†m ƒë√≥ng modal
            function closeModal(modalId) {
                document.getElementById(modalId).style.display = 'none';
            }

            // H√†m in ƒë∆°n h√†ng
            function printOrder() {
                window.print();
            }

            // ƒê√≥ng modal khi click b√™n ngo√†i
            window.onclick = function(event) {
                const modal = document.getElementById('orderDetailModal');
                if (event.target === modal) {
                    closeModal('orderDetailModal');
                }
            }

            // H√†m c·∫≠p nh·∫≠t n√∫t ƒëƒÉng nh·∫≠p/ƒëƒÉng xu·∫•t
            function updateAuthButtons(user) {
                const authButtons = document.getElementById('authButtons');
                if (user) {
                    authButtons.innerHTML = `
                        <div class="user-menu" onclick="confirmLogout()">
                            <span>üë§</span>
                            <span>${user.email}</span>
                        </div>
                    `;
                } else {
                    authButtons.innerHTML = `
                        <a href="#" class="login-btn" onclick="showModal('loginModal')">
                            <span>üë§</span>
                            <span>ƒêƒÉng nh·∫≠p</span>
                        </a>
                    `;
                }
            }

            // H√†m x√°c nh·∫≠n ƒëƒÉng xu·∫•t
            function confirmLogout() {
                Swal.fire({
                    title: 'X√°c nh·∫≠n ƒëƒÉng xu·∫•t',
                    text: 'B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ƒëƒÉng xu·∫•t?',
                    icon: 'question',
                    showCancelButton: true,
                    confirmButtonText: 'ƒêƒÉng xu·∫•t',
                    cancelButtonText: 'H·ªßy'
                }).then((result) => {
                    if (result.isConfirmed) {
                        // Show loading
                        Swal.fire({
                            title: 'ƒêang ƒëƒÉng xu·∫•t...',
                            allowOutsideClick: false,
                            didOpen: () => {
                                Swal.showLoading();
                            }
                        });

                        auth.signOut().then(() => {
                            window.location.href = 'index.html';
                        }).catch((error) => {
                            console.error('L·ªói khi ƒëƒÉng xu·∫•t:', error);
                            Swal.fire('L·ªói', 'Kh√¥ng th·ªÉ ƒëƒÉng xu·∫•t', 'error');
                        });
                    }
                });
            }
        </script>
          <script src="https://app.tudongchat.com/js/chatbox.js"></script>
          <script>
            const tudong_chatbox = new TuDongChat('fvnnpQFt5lp13VAR7GEiK')
            tudong_chatbox.initial()
          </script>
    </body>
</html> 